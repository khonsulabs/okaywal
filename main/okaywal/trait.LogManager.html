<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Customizes recovery and checkpointing behavior for a `WriteAheadLog`."><title>LogManager in okaywal - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Bold-a2c9cd1067f8b328.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../static.files/rustdoc-f3501f0f5ae15dfb.css" id="mainThemeStyle"><div id="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="okaywal" data-themes="" data-resource-suffix="" data-rustdoc-version="1.71.0 (8ede3aae2 2023-07-12)" data-search-js="search-4926e5fc22a5646a.js" data-settings-js="settings-de11bff964e9d4e5.js" data-settings-css="settings-8c76f75bfb6bd192.css" data-theme-light-css="light-0f8c037637f9eb3e.css" data-theme-dark-css="dark-1097f8e92a01e3cf.css" data-theme-ayu-css="ayu-614652228113ac93.css" ></div><script src="../static.files/storage-62ce34ea385b278a.js"></script><script defer src="sidebar-items.js"></script><script defer src="../static.files/main-f0540c1d82cde29b.js"></script><noscript><link rel="stylesheet" media="(prefers-color-scheme:light)" href="../static.files/light-0f8c037637f9eb3e.css"><link rel="stylesheet" media="(prefers-color-scheme:dark)" href="../static.files/dark-1097f8e92a01e3cf.css"><link rel="stylesheet" href="../static.files/noscript-13285aec31fa243e.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc trait"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="logo-container" href="../okaywal/index.html"><img class="rust-logo" src="../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2></h2></nav><nav class="sidebar"><a class="logo-container" href="../okaywal/index.html"><img class="rust-logo" src="../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2 class="location"><a href="#">LogManager</a></h2><div class="sidebar-elems"><section><h3><a href="#required-methods">Required Methods</a></h3><ul class="block"><li><a href="#tymethod.checkpoint_to">checkpoint_to</a></li><li><a href="#tymethod.recover">recover</a></li></ul><h3><a href="#provided-methods">Provided Methods</a></h3><ul class="block"><li><a href="#method.should_recover_segment">should_recover_segment</a></li></ul><h3><a href="#implementors">Implementors</a></h3></section><h2><a href="index.html">In okaywal</a></h2></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Trait <a href="index.html">okaywal</a>::<wbr><a class="trait" href="#">LogManager</a><button id="copy-path" title="Copy item path to clipboard"><img src="../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../src/okaywal/manager.rs.html#13-54">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><pre class="rust item-decl"><code>pub trait LogManager&lt;M = StdFileManager&gt;: <a class="trait" href="https://doc.rust-lang.org/1.71.0/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a> + <a class="trait" href="https://doc.rust-lang.org/1.71.0/core/marker/trait.Sync.html" title="trait core::marker::Sync">Sync</a> + <a class="trait" href="https://doc.rust-lang.org/1.71.0/core/fmt/trait.Debug.html" title="trait core::fmt::Debug">Debug</a> + 'static<span class="where fmt-newline">where
    M: FileManager,</span>{
    // Required methods
    fn <a href="#tymethod.recover" class="fn">recover</a>(&amp;mut self, entry: &amp;mut <a class="struct" href="struct.Entry.html" title="struct okaywal::Entry">Entry</a>&lt;'_, M::File&gt;) -&gt; <a class="type" href="https://doc.rust-lang.org/1.71.0/std/io/error/type.Result.html" title="type std::io::error::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.71.0/std/primitive.unit.html">()</a>&gt;;
<span class="item-spacer"></span>    fn <a href="#tymethod.checkpoint_to" class="fn">checkpoint_to</a>(
        &amp;mut self,
        last_checkpointed_id: <a class="struct" href="struct.EntryId.html" title="struct okaywal::EntryId">EntryId</a>,
        checkpointed_entries: &amp;mut <a class="struct" href="struct.SegmentReader.html" title="struct okaywal::SegmentReader">SegmentReader</a>&lt;M::File&gt;,
        wal: &amp;<a class="struct" href="struct.WriteAheadLog.html" title="struct okaywal::WriteAheadLog">WriteAheadLog</a>&lt;M&gt;
    ) -&gt; <a class="type" href="https://doc.rust-lang.org/1.71.0/std/io/error/type.Result.html" title="type std::io::error::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.71.0/std/primitive.unit.html">()</a>&gt;;

    // Provided method
    fn <a href="#method.should_recover_segment" class="fn">should_recover_segment</a>(
        &amp;mut self,
        _segment: &amp;<a class="struct" href="struct.RecoveredSegment.html" title="struct okaywal::RecoveredSegment">RecoveredSegment</a>
    ) -&gt; <a class="type" href="https://doc.rust-lang.org/1.71.0/std/io/error/type.Result.html" title="type std::io::error::Result">Result</a>&lt;<a class="enum" href="enum.Recovery.html" title="enum okaywal::Recovery">Recovery</a>&gt; { ... }
}</code></pre><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Customizes recovery and checkpointing behavior for a
<a href="struct.WriteAheadLog.html" title="struct okaywal::WriteAheadLog"><code>WriteAheadLog</code></a>.</p>
</div></details><h2 id="required-methods" class="small-section-header">Required Methods<a href="#required-methods" class="anchor">§</a></h2><div class="methods"><details class="toggle method-toggle" open><summary><section id="tymethod.recover" class="method"><a class="srclink rightside" href="../src/okaywal/manager.rs.html#33">source</a><h4 class="code-header">fn <a href="#tymethod.recover" class="fn">recover</a>(&amp;mut self, entry: &amp;mut <a class="struct" href="struct.Entry.html" title="struct okaywal::Entry">Entry</a>&lt;'_, M::File&gt;) -&gt; <a class="type" href="https://doc.rust-lang.org/1.71.0/std/io/error/type.Result.html" title="type std::io::error::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.71.0/std/primitive.unit.html">()</a>&gt;</h4></section></summary><div class="docblock"><p>Invoked once for each entry contained in all recovered segments within a
<a href="struct.WriteAheadLog.html" title="struct okaywal::WriteAheadLog"><code>WriteAheadLog</code></a>.</p>
<p><a href="struct.Entry.html#method.read_chunk" title="method okaywal::Entry::read_chunk"><code>Entry::read_chunk()</code></a> can be used to read each chunk of data that was
written via
<a href="struct.EntryWriter.html#method.write_chunk" title="method okaywal::EntryWriter::write_chunk"><code>EntryWriter::write_chunk</code></a>. The order
of chunks is guaranteed to be the same as the order they were written
in.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.checkpoint_to" class="method"><a class="srclink rightside" href="../src/okaywal/manager.rs.html#48-53">source</a><h4 class="code-header">fn <a href="#tymethod.checkpoint_to" class="fn">checkpoint_to</a>(
    &amp;mut self,
    last_checkpointed_id: <a class="struct" href="struct.EntryId.html" title="struct okaywal::EntryId">EntryId</a>,
    checkpointed_entries: &amp;mut <a class="struct" href="struct.SegmentReader.html" title="struct okaywal::SegmentReader">SegmentReader</a>&lt;M::File&gt;,
    wal: &amp;<a class="struct" href="struct.WriteAheadLog.html" title="struct okaywal::WriteAheadLog">WriteAheadLog</a>&lt;M&gt;
) -&gt; <a class="type" href="https://doc.rust-lang.org/1.71.0/std/io/error/type.Result.html" title="type std::io::error::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.71.0/std/primitive.unit.html">()</a>&gt;</h4></section></summary><div class="docblock"><p>Invoked each time the <a href="struct.WriteAheadLog.html" title="struct okaywal::WriteAheadLog"><code>WriteAheadLog</code></a> is ready
to recycle and reuse segment files.</p>
<p><code>last_checkpointed_id</code> is the id of the last entry that is being
checkedpointed and removed from the log. If needed,
<code>checkpointed_entries</code> can be used to iterate over all entries that are
being checkpointed.</p>
<p>Shortly after this function returns, the entries stored within the file
being checkpointed will no longer be accessible. To ensure ACID
compliance of the underlying storage layer, all necessary changes must
be fully synchronized to the underlying storage medium before this
function returns.</p>
</div></details></div><h2 id="provided-methods" class="small-section-header">Provided Methods<a href="#provided-methods" class="anchor">§</a></h2><div class="methods"><details class="toggle method-toggle" open><summary><section id="method.should_recover_segment" class="method"><a class="srclink rightside" href="../src/okaywal/manager.rs.html#21-23">source</a><h4 class="code-header">fn <a href="#method.should_recover_segment" class="fn">should_recover_segment</a>(
    &amp;mut self,
    _segment: &amp;<a class="struct" href="struct.RecoveredSegment.html" title="struct okaywal::RecoveredSegment">RecoveredSegment</a>
) -&gt; <a class="type" href="https://doc.rust-lang.org/1.71.0/std/io/error/type.Result.html" title="type std::io::error::Result">Result</a>&lt;<a class="enum" href="enum.Recovery.html" title="enum okaywal::Recovery">Recovery</a>&gt;</h4></section></summary><div class="docblock"><p>When recovering a <a href="struct.WriteAheadLog.html" title="struct okaywal::WriteAheadLog"><code>WriteAheadLog</code></a>, this function
is called for each segment as it is read. To allow the segment to have
its data recovered, return <a href="enum.Recovery.html#variant.Recover" title="variant okaywal::Recovery::Recover"><code>Recovery::Recover</code></a>. If you wish to abandon
the data contained in the segment, return <a href="enum.Recovery.html#variant.Abandon" title="variant okaywal::Recovery::Abandon"><code>Recovery::Abandon</code></a>.</p>
</div></details></div><h2 id="implementors" class="small-section-header">Implementors<a href="#implementors" class="anchor">§</a></h2><div id="implementors-list"><section id="impl-LogManager%3CM%3E-for-LogVoid" class="impl"><a class="srclink rightside" href="../src/okaywal/manager.rs.html#70-90">source</a><a href="#impl-LogManager%3CM%3E-for-LogVoid" class="anchor">§</a><h3 class="code-header">impl&lt;M&gt; <a class="trait" href="trait.LogManager.html" title="trait okaywal::LogManager">LogManager</a>&lt;M&gt; for <a class="struct" href="struct.LogVoid.html" title="struct okaywal::LogVoid">LogVoid</a><span class="where fmt-newline">where
    M: FileManager,</span></h3></section></div><script src="../implementors/okaywal/manager/trait.LogManager.js" async></script></section></div></main></body></html>